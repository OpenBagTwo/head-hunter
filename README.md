# Wandering Head Hunter

Utilities for creating customized datapacks that provide the wandering trader
with player head trades

**The entire credit for the datapack itself** goes to the [**Vanilla Tweaks**](https://vanillatweaks.net)
team and their Wandering Trades datapack upon which this is based.

## Installation and Setup

This scripts in this repo require python 3.8 or newer and requires no other dependencies to run.

Thus, all you need to do to run these scripts is to download this repo and run the commands below from the
project's root folder.

You'll also need to grab yourself a copy of the Wandering Trader datapack.
1. Go to the Vanilla Tweaks [datapacks page](https://vanillatweaks.net/picker/datapacks/)
1. Under "Hermitcraft," select "More Mob Heads" and "Wandering Trades (Hermit Edition)"
1. Download the zip archive and extract the "UNZIP_ME" parent zip file into the "packs" folder.

You should now have a folder named `Head Hunter` whose top-level contents are:
* a `data` directory
* a file named `pack.mcmeta`
* an icon named `pack.png`

## Usage

This package contains three modules: `parse`, for parsing a list of player heads from a trade list or loot table,
`write`, for generating the list of trades, and `release` for packaging up the datapack

### `parse`

The `parse` module has utilities or parsing player heads from the "Wandering Trades (Hermit Edition)"
and "More Mob Heads" datapacks (in case you can't quite stomach chopping the head off a blue Axolotl).

Both `parse.parse_trades` and `parse.parse_mob_head_specs` take a filename or path pointing to the datapack
file to extract head specs from. For the former, you'll want to grab `data/wandering_trades/functions/add_trade.mcfunction`,
for the latter, it will be the loot table JSON of the mob whose head(s) you want to make available for trade
(_e.g._ `data/minecraft/loot_tables/entities/turtle.json`).

Each method will then spit out a list of one-item dicts, where the key is the name of the player or mob,
and the value is the unique part of the player-head spec that needs to be slotted into the trade template.

You can serialize these lists however you want. I definitely had `yaml` in mind when designing the format, but
you do you. Importantly, **you can combine the lists from these two methods**, append on your own custom player heads,
or remove the heads of any Hermits you don't want.


### Note

If you want the Wandering Trader to offer a player's current head, you can append an entry
to the head list that's just a string (instead of a one-item dict) of the player's username.

### `write`

The `write` moduile contains everything you should need to generate your custom Wandering Trader datapack.

#### Writing the Trade List



First, `write.write_trades` takes that list of one-item dicts generated by the parsing methods (and that you hopefully
tweaked by hand) and overwites the `Head Hunter/data/wandering_trades/functions/add_trade.mcfunction` file (which is why
it's important you follow the directions in the **Setup** section exactly).

After running `write.write_trades` I **highly recommend** you then read the file back by calling:

```python
>>> from head_hunter import parse  # if you haven't already
>>> _ = parse.parse_trades("Head Hunter/data/wandering_trades/functions/add_trade.mcfunction")
```

and making sure the utility doesn't throw any errors.



#### Updating the Random Number Generator

A utility to do this is currently TODO, but as it stands, you should literally just be altering one line.

Open up `Head Hunter/data/wandering_trades/functions/add_trade.mcfunction` and get the number of the final trade
(which, incidentally, should just be `len(trade_list) + 1`). Now go into `provide_hermit_trades.mcfunction` in the same folder
and look for the section that reads:

```
# Hermit Heads index
scoreboard players set @s math_input1 2
scoreboard players set @s math_input2 30
```

and replace the value of `math_input2` with that final trade number (so if you had fifty trades, that line would read:
`scoreboard players set @s math_input2 51`).

Save the file and close it.

#### Updating `pack.mcmeta`

This step is completely optional--`pack.mcmeta` is super easy to edit by hand--but if you want, `write.write_mcmeta` will
generate one for you and version it using [calver](https://calver.org/).

### `release`

This module contains a single method, `release.make_zip` which bundle up your pack folder as a datapack zip file. Basically
I just threw it in to make it easier to build some sort of automated deployment script.

## Contributing

A development environment is provided in the form of a
[conda `environment.yml` file](https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html).
I highly recommend the [mambaforge](https://github.com/conda-forge/miniforge#mambaforge)
distribution of conda.

For ease of style-guide enforcement, a [pre-commit](https://pre-commit.com/) configuration has been
provided.
